<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}DBC{% endblock %}</title>
        {% block stylesheets %}
            <link rel="stylesheet" 
                  href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
                  integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" 
                  crossorigin="anonymous">
            <link rel="stylesheet" 
                  href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" 
                  integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" 
                  crossorigin="anonymous">
            <style>
                body {
                    min-height:100vh;
                }
                
                main {
                    padding: 16px 0 16px 0;
                }

                .flex-fill {
                    flex:1 1 auto;
                } 
 
                .ui-autocomplete {
                    position: absolute;
                    z-index: 1000;
                    cursor: default;
                    padding: 0;
                    margin-top: 2px;
                    list-style: none;
                    background-color: #ffffff;
                    border: 1px solid #ccc;
                    -webkit-border-radius: 5px;
                       -moz-border-radius: 5px;
                            border-radius: 5px;
                    -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
                       -moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
                            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
                }
                .ui-autocomplete > li {
                    padding: 3px 20px;
                    cursor:pointer;
                }
                .ui-autocomplete > li.ui-state-focus {
                    background-color: #DDD;
                }
                .ui-helper-hidden-accessible {
                    display: none;
                }

            </style>
        {% endblock %}
    </head>
    <body class="d-flex flex-column">
        <div class="container-fluid">
            <div class="row">
                {% block navbar %}{% endblock %}
            </div>
        </div>
        <div class="container flex-fill">    
            <div class="row">
                {% block info %}{% endblock %}
            </div>            
            <main class="row">
                {% block body %}{% endblock %}
            </main>
        </div>
        <div class="container-fluid">
            <div class="row">
                {% block footer %}{% endblock %}
            </div>            
        </div>
        {% block javascripts %}
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>        
            <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" 
                    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" 
                    crossorigin="anonymous"></script> 
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" 
                    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" 
                    crossorigin="anonymous"></script> 
              

            <script>

                $(document).ready(function() {       
                    function split( val ) {
                      return val.split( /,\s*/ );
                    }
                    function extractLast( term ) {
                      return split( term ).pop();
                    }

                    $( "#app_transfer_files" )
                        // don't navigate away from the field on tab when selecting an item
                        .on( "keydown", function( event ) {
                            if ( event.keyCode === $.ui.keyCode.TAB && $( this ).autocomplete( "instance" ).menu.active ) {
                                event.preventDefault();
                            }
                        })
                        .autocomplete({
                            source: function( request, response ) {
                                var lastIndex = request.term.lastIndexOf(",");
                                var term = request.term.substring(lastIndex + 1);
                                $.getJSON( "http://localhost:8000/file/test/"+term.trim(), {}, response );
                            },
                            search: function() {
                                // custom minLength
                                var term = extractLast( this.value );
                                if ( term.length < 1 ) {
                                    return false;
                                }
                            },
                            focus: function() {
                                // prevent value inserted on focus
                                return false;
                            },
                            select: function( event, ui ) {
                                var terms = split( this.value );
                                // remove the current input
                                terms.pop();
                                // add the selected item
                                terms.push( ui.item.value );
                                // add placeholder to get the comma-and-space at the end
                                terms.push( "" );
                                this.value = terms.join( ", " );
                                return false;
                            }
                        });
                });

            </script>
              
        {% endblock %}
    </body>
</html>
